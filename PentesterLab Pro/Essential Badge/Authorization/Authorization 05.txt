Authorization 05

In this exercise, the developer fixed the previous bug. You cannot create a user with admin privileges... or at least not directly.
 Try to find a way to do the same thing.

  You can access this exercise using the following URL: http://ptc-ad89f29b-ec9904f9.libcurl.so/. 

  Steps: 
1) Visit the given link: http://ptc-ad89f29b-ec9904f9.libcurl.so/. 
2) Register with username 'user1' and password 'password'. But it don't works.
    The objective of this exercise is to find a way to become a user with the admin privilege"...
   You don't have admin privileges.
3) Let's try burpsuite.Again register with new username 'user2' and password 'password'. And look at the HTTP history. 
   We can see /Post method in url /update_profile. 
   In request we can get user%5Busername%5D=user2&user%5Bpassword%5D=password&submit=Submit. Simple decode that url with ctrl+shift+U.
   And result is: user[username]=user2&user[password]=password&submit=Submit.
4) We can see that there is probably a object user with multiple attributes. One being username and one being password.
T  here is another attribute named admin and that will look something like that.
5) Now let's add one malicious attribute when we register. A user hopefully going to become admin.
    Then we are going to register user3 and submit. Intercept this one in burpsuite. We can see the request now and going to add a malicious attribute
    user[admin]=true. It results: user%5Busername%5D=user4&user%5Bpassword%5D=user4&submit=Submit&user[admin]=true. It doesn't works always as previous lab Authorization 0.4.
6) So if it don't work, we can add simply modify the malicious code user[admin]=1. 
    The results: user%5Busername%5D=user2&user%5Bpassword%5D=password&submit=Submit&user[admin]=1
7) Now,forward to the browser.
8) Boom!!You have admin privileges. Congratulations, you solved this challenge, the key is: f211616c-052f-476c-8207-ba6438a84dc1

Happy Hacking!! :) 